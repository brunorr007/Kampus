<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fórum | Gabarita.ai</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>

<body class="min-h-screen font-sans text-gray-100 crt-effect">
    <div class="particles-background"></div>
    <!-- Header Fixo (Estilo App) -->
    <header
        class="fixed top-0 left-0 w-full h-[60px] bg-[#121212]/90 backdrop-blur-md flex items-center justify-between px-4 z-50 border-b border-white/10">
        <div class="text-xl font-extrabold text-white">Kampus<span class="text-[#8b5cf6]">.</span></div>
        <button id="btnLogout"
            class="w-10 h-10 flex items-center justify-center rounded-full text-gray-400 hover:bg-white/10">
            <i data-feather="log-out" class="w-5 h-5"></i>
        </button>
    </header>

    <!-- Espaçamento para o Header -->
    <div class="h-[70px]"></div>

    <div class="container mx-auto px-4 pb-24 max-w-2xl">
        <div class="grid grid-cols-1 gap-6">

            <!-- Cards de Login/Perfil (Mantidos mas estilizados) -->
            <div id="authSection">
                <!-- Login Card -->
                <div id="loginCard"
                    class="card bg-[#1e1e1e] border border-white/10 rounded-2xl p-6 text-center shadow-lg">
                    <div class="w-16 h-16 bg-[#8b5cf6]/20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-feather="user" class="w-8 h-8 text-[#8b5cf6]"></i>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">Bem-vindo à Comunidade</h2>
                    <p class="text-gray-400 mb-6 text-sm">Entre para participar das discussões</p>
                    <button id="btnLogin"
                        class="w-full bg-[#8b5cf6] hover:bg-[#7c3aed] text-white font-bold py-3 px-4 rounded-xl flex items-center justify-center gap-2 transition-all">
                        <i data-feather="chrome" class="w-4 h-4"></i>
                        Entrar com Google
                    </button>
                </div>

                <!-- Profile Card -->
                <div id="profileCard"
                    class="hidden flex items-center gap-4 bg-[#1e1e1e] p-4 rounded-2xl border border-white/10">
                    <img id="userPhoto" src="" class="w-12 h-12 rounded-full border-2 border-[#8b5cf6]">
                    <div class="flex-1 min-w-0">
                        <h2 id="userName" class="text-white font-bold truncate">Usuário</h2>
                        <p id="userEmail" class="text-gray-400 text-xs truncate">email@example.com</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-gray-500">Membro</p>
                        <span class="inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                    </div>
                </div>
            </div>

            <!-- Feed Principal -->
            <main class="space-y-6">
                <!-- Barra de Pesquisa -->
                <div class="search-container relative mb-6">
                    <i data-feather="search" class="absolute left-4 top-3.5 text-gray-400 w-5 h-5"></i>
                    <input type="text" id="searchPosts" placeholder="Pesquisar discussões..."
                        class="w-full pl-12 pr-4 py-3 rounded-xl bg-black/50 border border-[#00f5d4]/30 focus:border-[#00f5d4] focus:ring-1 focus:ring-[#00f5d4] text-white placeholder-gray-500 transition-all">
                </div>

                <!-- Área de Criar Post (S aparece logado) -->
                <div id="createPostArea" class="prova-card hidden">
                    <h3 class="text-lg font-bold text-[#00f5d4] mb-4 flex items-center">
                        <i data-feather="plus-circle" class="w-5 h-5 mr-2"></i>
                        Criar Nova Discussão
                    </h3>
                    <form id="postForm" class="space-y-4">
                        <div>
                            <input type="text" id="postTitle" placeholder="Título da discussão..."
                                class="w-full px-4 py-3 rounded-lg bg-black/50 border border-[#00f5d4]/30 focus:border-[#00f5d4] focus:ring-2 focus:ring-[#00f5d4]/50 text-white placeholder-gray-500 transition-all"
                                required maxlength="100">
                        </div>
                        <div>
                            <textarea id="postContent" rows="3"
                                placeholder="O que você quer discutir? (Dúvidas, memes, discussões...)"
                                class="w-full px-4 py-3 rounded-lg bg-black/50 border border-[#00f5d4]/30 focus:border-[#00f5d4] focus:ring-2 focus:ring-[#00f5d4]/50 text-white placeholder-gray-500 transition-all resize-none"
                                required maxlength="1000"></textarea>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-xs text-gray-500" id="charCount">0/1000</span>
                            <button type="submit" class="btn-neon">
                                <i data-feather="send" class="w-4 h-4 inline mr-2"></i>
                                Publicar
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Lista de Posts -->
                <div id="postsFeed" class="space-y-4">
                    <!-- Posts serão injetados aqui via JavaScript -->
                    <div class="text-center py-12">
                        <i data-feather="loader" class="w-8 h-8 mx-auto animate-spin text-[#00f5d4]"></i>
                        <p class="text-gray-400 mt-2">Carregando discussões...</p>
                    </div>
                </div>

                <!-- Estado Vazio (quando não há posts) -->
                <div id="emptyState" class="hidden text-center py-12 prova-card">
                    <i data-feather="inbox" class="w-16 h-16 mx-auto text-gray-600 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-400 mb-2">Nenhuma discussão ainda</h3>
                    <p class="text-gray-500">Seja o primeiro a criar um post!</p>
                </div>
            </main>
        </div>
    </div>

    <!-- Bottom Navigation Bar (Fixo) -->
    <nav
        class="fixed bottom-0 left-0 w-full h-[64px] bg-[#121212]/90 backdrop-blur-md border-t border-white/10 flex justify-around items-center z-50">
        <a href="index.html"
            class="flex flex-col items-center justify-center text-[#b3b3b3] text-xs gap-1 w-full h-full">
            <i data-feather="home" class="w-6 h-6"></i>
            <span>Home</span>
        </a>
        <a href="estudos.html"
            class="flex flex-col items-center justify-center text-[#b3b3b3] text-xs gap-1 w-full h-full">
            <i data-feather="book" class="w-6 h-6"></i>
            <span>Estudos</span>
        </a>
        <a href="market.html"
            class="flex flex-col items-center justify-center text-[#b3b3b3] text-xs gap-1 w-full h-full">
            <i data-feather="shopping-bag" class="w-6 h-6"></i>
            <span>Market</span>
        </a>
        <a href="eventos.html"
            class="flex flex-col items-center justify-center text-[#b3b3b3] text-xs gap-1 w-full h-full">
            <i data-feather="calendar" class="w-6 h-6"></i>
            <span>Rolês</span>
        </a>
        <a href="forum.html"
            class="flex flex-col items-center justify-center text-[#8b5cf6] text-xs gap-1 w-full h-full">
            <i data-feather="user" class="w-6 h-6"></i>
            <span>Perfil</span>
        </a>
    </nav>

    <!-- Modal de Criação de Username -->
    <div id="usernameModal"
        class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="prova-card max-w-md w-full animate__animated animate__fadeInDown">
            <div class="text-center mb-6">
                <i data-feather="user-check" class="w-16 h-16 mx-auto text-[#00f5d4] mb-4"></i>
                <h2 class="text-2xl font-bold text-white mb-2">Bem-vindo ao Fórum!</h2>
                <p class="text-gray-400">Para continuar, escolha um nome de usuário único. Você será identificado por
                    este nome nas discussões.</p>
            </div>

            <form id="usernameForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Nome de Usuário</label>
                    <div class="relative">
                        <span class="absolute left-4 top-3 text-[#00f5d4]">@</span>
                        <input type="text" id="usernameInput" placeholder="EngenheiroCansado"
                            class="w-full pl-10 pr-4 py-3 rounded-lg bg-black/50 border border-[#00f5d4]/30 focus:border-[#00f5d4] focus:ring-2 focus:ring-[#00f5d4]/50 text-white placeholder-gray-500 transition-all"
                            required minlength="3" maxlength="20" pattern="[a-zA-Z0-9_]+"
                            title="Apenas letras, números e underline">
                    </div>
                    <p class="text-xs text-gray-500 mt-1">Apenas letras, números e underline (_). Mínimo 3 caracteres.
                    </p>
                    <p id="usernameError" class="text-sm text-red-400 mt-2 hidden">Este nome de usuário já existe.</p>
                </div>

                <button type="submit" class="btn-neon w-full">
                    <i data-feather="check" class="w-4 h-4 inline mr-2"></i>
                    Confirmar e Entrar
                </button>
            </form>
        </div>
    </div>

    <custom-footer></custom-footer>

    <!-- Scripts -->
    <script src="firebase-config.js"></script>
    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <script src="script_forum.js"></script>
    <script src="script.js"></script>
    <script>
        feather.replace();
    </script>
</body>

</html>